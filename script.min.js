function initHeaderScripts(){initMobileMenu(),initThemeToggle()}function initPageScripts(){initFormValidation()}function initSPA(){document.body.addEventListener("click",e=>{const t=e.target.closest("a.spa-link");if(t){e.preventDefault();const n=t.getAttribute("href");loadPage(n)}}),window.addEventListener("popstate",e=>{const t=e.state?e.state.path:"index.html";loadPage(t,!0)}),history.replaceState({path:window.location.pathname.split("/").pop()||"index.html"},"",window.location.href)}async function loadPage(e,t=!1){try{const n=await fetch(e);if(!n.ok)throw new Error("Página não encontrada");const a=await n.text(),o=new DOMParser,i=o.parseFromString(a,"text/html"),l=i.getElementById("main-content"),r=i.title;l&&(document.getElementById("main-content").innerHTML=l.innerHTML,document.title=r,updateActiveNav(e),t||history.pushState({path:e},r,e),initPageScripts(),window.scrollTo(0,0))}catch(e){console.error("Erro ao carregar página:",e)}}function updateActiveNav(e){const t=document.querySelectorAll("nav a.spa-link");t.forEach(t=>{const n=t.getAttribute("href").split("/").pop(),a=e.split("/").pop();n===a?t.classList.add("active"):t.classList.remove("active")})}function initMobileMenu(){const e=document.getElementById("menu-toggle-btn"),t=document.getElementById("navMenu");e&&t&&e.addEventListener("click",()=>{const n=t.classList.toggle("show");n?(e.setAttribute("aria-label","Fechar menu"),e.setAttribute("aria-expanded","true")):(e.setAttribute("aria-label","Abrir menu"),e.setAttribute("aria-expanded","false"))});const n=document.querySelectorAll(".dropdown-container");n.forEach(e=>{const t=e.querySelector("a");t.addEventListener("click",function(n){const a=document.querySelector(".menu-toggle");a&&"block"===window.getComputedStyle(a).display&&(t.classList.contains("spa-link")||(n.preventDefault(),document.querySelectorAll(".dropdown-container.open").forEach(t=>{t!==e&&t.classList.remove("open")}),e.classList.toggle("open")))})})}function initFormValidation(){const e=document.getElementById("volunteerForm");if(!e)return;e.addEventListener("submit",handleSubmit);const t=document.getElementById("cpf"),n=document.getElementById("cep"),a=document.getElementById("telefone");t&&t.addEventListener("input",maskCPF),n&&n.addEventListener("input",maskCEP),a&&a.addEventListener("input",maskTelefone)}function handleSubmit(e){e.preventDefault();const t=e.target,n=document.getElementById("successMessage"),a=document.getElementById("errorMessage");n.style.display="none",a.style.display="none",a.innerHTML="";const o=validateForm(t);if(o.length>0){a.style.display="block";let e="<strong>Por favor, corrija os seguintes erros:</strong><ul>";o.forEach(t=>{e+=`<li>${t}</li>`}),e+="</ul>",a.innerHTML=e}else n.style.display="block",t.reset(),setTimeout(()=>{n.style.display="none"},5e3)}function validateForm(e){const t=[],n=e.elements.nome.value,a=e.elements.cpf.value;n.trim().split(" ").length<2&&t.push('O campo "Nome Completo" deve conter nome e sobrenome.');const o=a.replace(/\D/g,"");return 11!==o.length&&t.push('O campo "CPF" está incompleto.'),t}function maskCPF(e){let t=e.target.value;t=t.replace(/\D/g,""),t=t.replace(/(\d{3})(\d)/,"$1.$2"),t=t.replace(/(\d{3})(\d)/,"$1.$2"),t=t.replace(/(\d{3})(\d{1,2})$/,"$1-$2"),e.target.value=t}function maskCEP(e){let t=e.target.value;t=t.replace(/\D/g,""),t=t.replace(/^(\d{5})(\d)/,"$1-$2"),e.target.value=t}function maskTelefone(e){let t=e.target.value;t=t.replace(/\D/g,""),t=t.replace(/^(\d{2})(\d)/g,"($1) $2"),t=t.replace(/(\d{5})(\d)/,"$1-$2"),e.target.value=t}function initThemeToggle(){const e=document.getElementById("theme-toggle-btn");if(!e)return;const t=localStorage.getItem("theme");"dark"===t?document.documentElement.setAttribute("data-theme","dark"):"light"===t?document.documentElement.setAttribute("data-theme","light"):window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&document.documentElement.setAttribute("data-theme","dark"),e.addEventListener("click",()=>{let e=document.documentElement.getAttribute("data-theme");"dark"===e?(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light")):(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark"))})}document.addEventListener("DOMContentLoaded",()=>{initHeaderScripts(),initSPA(),initPageScripts()});